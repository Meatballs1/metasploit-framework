# -*- coding: binary -*-

require 'msf/core/framework'

module Rex
module Exploitation

###
#
# This class provides the ability to create a sequence of commands from an executable.
# When this sequence is ran via command injection or a shell, the resulting exe will
# be written to disk and executed.
#
# This particular version uses tftp.exe to download a binary from the specified
# server.  The original file is preserve, not encoded at all, and so this version
# is significantly simpler than other methods.
#
# Requires: powershell.exe
#
# Written by Ben Campbell
#
###

class CmdStagerPowershell < CmdStagerBase

  def initialize(exe)
    super
    @payload_exe = exe
  end

  def generate(opts)
    # Initiate the download
    cmds = [@payload_exe]
  end
end
end
end
